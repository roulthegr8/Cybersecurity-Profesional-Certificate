# Explore signatures and logs with Suricata
 
## Introduction
In this lab activity, you'll explore the components of a rule using Suricata. You'll also have an opportunity to trigger a rule and examine the output in Suricata. You'll use the Bash shell to complete these steps. 

What you’ll do
- You have multiple tasks in this lab:
- Examine a rule in Suricata
- Trigger a rule and review the alert logs
- Examine eve.json outputs

### Activity: Examine alerts, logs, and rules with Suricata

Activity overview
Previously, you learned about packet analysis and the basic syntax and components of intrusion detection systems (IDS) signatures and rules. You also learned how to examine a prewritten signature and its log output in Suricata, an open-source intrusion detection system, intrusion prevention system, and network analysis tool.

In this lab activity, you’ll explore more about Suricata alerts and logs, including the general process of rule creation.

The Suricata tool monitors network interfaces and applies rules to the packets that pass through the interface. Suricata determines whether each packet should generate an alert and be dropped, rejected, or allowed to pass through the interface.

Source and destination networks must be specified in the Suricata configuration. Custom rules can be written to specify which traffic should be processed.

You’ll examine a rule and practice using Suricata to trigger alerts on network traffic. You’ll also analyze log outputs, such as a fast.log and eve.json file. This will help you understand some of the alerts and logs generated by Suricata.


### Scenario
In this scenario, you’re a security analyst who must monitor traffic on your employer's network. You’ll be required to configure Suricata and use it to trigger alerts.

Here’s how you'll do this task: 
1. First, you'll explore custom rules in Suricata. 
2. Second, you'll run Suricata with a custom rule in order to trigger it, and examine the output logs in the fast.log file. 
3. Finally, you’ll examine the additional output that Suricata generates in the standard eve.json log file.

For the purposes of the tests you’ll run in this lab activity, you’ve been supplied with a sample.pcap file and a custom.rules file. These reside in your home folder.

Let’s define the files you’ll be working with in this lab activity:

- The sample.pcap file is a packet capture file that contains an example of network traffic data, which you’ll use to test the Suricata rules. This will allow you to simulate and repeat the exercise of monitoring network traffic.

- The custom.rules file contains a custom rule when the lab activity starts. You’ll add rules to this file and run them against the network traffic data in the sample.pcap file.

- The fast.log file will contain the alerts that Suricata generates. The fast.log file is empty when the lab starts. Each time you test a rule, or set of rules, against the sample network traffic data, Suricata adds a new alert line to the fast.log file when all the conditions in any of the rules are met. The fast.log file can be located in the /var/log/suricata directory after Suricata runs.The fast.log file is considered to be a depreciated format and is not recommended for incident response or threat hunting tasks but can be used to perform quick checks or tasks related to quality assurance.

- The eve.json file is the main, standard, and default log for events generated by Suricata. It contains detailed information about alerts triggered, as well as other network telemetry events, in JSON format. The eve.json file is generated when Suricate runs, and can also be located in the /var/log/suricata directory.

When you create a new rule, you'll need to test the rule to confirm whether or not it worked as expected. You can use the fast.log file to quickly compare the number of alerts generated each time you run Suricata to test a signature against the sample.pcap file.

### Task 1 Examine a custom rule in Suricata

![image](https://github.com/roulthegr8/Cybersecurity-Profesional-Certificate/assets/90126847/6a02ddad-de6e-4d4b-a9bd-e1847478352a)

### Task 2. Trigger a custom rule in Suricata

![image](https://github.com/roulthegr8/Cybersecurity-Profesional-Certificate/assets/90126847/32f708d1-58a6-4f43-9d91-785cb60d64ef)

### Task 3. Examine eve.json output

![image](https://github.com/roulthegr8/Cybersecurity-Profesional-Certificate/assets/90126847/941caddb-5863-47fa-a1a5-504f79a3b282)

![image](https://github.com/roulthegr8/Cybersecurity-Profesional-Certificate/assets/90126847/7f05035d-b9fb-4a36-ba2c-d5a424e4a1b3)

![image](https://github.com/roulthegr8/Cybersecurity-Profesional-Certificate/assets/90126847/d1dc977e-60df-4243-a633-860a3132e54d)













